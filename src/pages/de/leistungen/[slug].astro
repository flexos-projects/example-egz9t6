```astro
---
import { getCollection, getEntry } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import BaseLayout from '../../../layouts/BaseLayout.astro';
import MinimalHero from '../../../components/heroes/MinimalHero.astro';
import CtaBanner from '../../../components/cta/CtaBanner.astro';
import ProcessStep from '../../../components/content/ProcessStep.astro';
import FeaturedCard from '../../../components/cards/FeaturedCard.astro';
import TestimonialBlock from '../../../components/content/TestimonialBlock.astro';
import Icon from 'astro-icon';

export async function getStaticPaths() {
  const services = await getCollection('services', ({ id }) => id.startsWith('de/'));
  return services.map(service => ({
    params: { slug: service.slug.replace('de/', '') },
    props: { service },
  }));
}

interface Props {
  service: CollectionEntry<'services'>;
}

const { service } = Astro.props;
const { data } = service;

// Fetch related content if it exists
const relatedCaseStudy = data.related_case_studies ? await getEntry(data.related_case_studies) : null;
const testimonial = data.testimonial ? await getEntry(data.testimonial) : null;
---
<BaseLayout 
  title={`${data.title} | InnovationHub Solutions`} 
  description={data.seo_description || data.summary}
  language="de"
>
  <MinimalHero
    title={data.title}
    subtitle={data.introduction}
    ctaLabel="Projekt besprechen"
    ctaHref="/de/kontakt"
  />

  {data.problem_checklist && data.problem_checklist.length > 0 && (
    <section class="py-16 md:py-24 bg-surface-100">
      <div class="mx-auto max-w-7xl px-4 md:px-8 lg:px-12">
        <div class="max-w-3xl mx-auto text-center">
          <h2 class="font-inter text-3xl md:text-4xl font-semibold text-primary-700">Ist diese Leistung für Sie geeignet?</h2>
          <p class="mt-4 font-lora text-lg text-surface-900 opacity-90">Wenn Sie eine dieser Herausforderungen erkennen, können wir Ihnen helfen, eine Lösung zu finden.</p>
        </div>
        <div class="mt-12 grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {data.problem_checklist.map((problem) => (
            <div class="flex items-start space-x-4 opacity-0 translate-y-6 motion-safe:animate-[fade-in-up_500ms_ease-out_forwards]">
              <div class="flex-shrink-0 mt-1">
                <Icon name="lucide:check-circle-2" class="w-6 h-6 text-accent-500" />
              </div>
              <p class="font-lora text-base text-surface-900">{problem}</p>
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  {data.process_steps && data.process_steps.length > 0 && (
    <section class="py-16 md:py-24 bg-surface-50">
      <div class="mx-auto max-w-7xl px-4 md:px-8 lg:px-12">
        <div class="max-w-3xl mx-auto text-center mb-12 md:mb-16">
          <h2 class="font-inter text-3xl md:text-4xl font-semibold text-primary-700">Unser bewährter Ansatz</h2>
          <p class="mt-4 font-lora text-lg text-surface-900 opacity-90">Wir folgen einem strukturierten Prozess, um sicherzustellen, dass unsere Lösungen Ihre Ziele nicht nur erfüllen, sondern übertreffen.</p>
        </div>
        <div class="space-y-16 md:space-y-20">
          {data.process_steps.map((step, index) => (
            <ProcessStep
              title={step.step_title}
              description={step.step_description}
              image={`https://source.unsplash.com/random/800x600/?process,step${index+1}`}
              imageAlt={step.step_title}
              isReversed={index % 2 !== 0}
              animationDelay={index * 150}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  {relatedCaseStudy && (
    <section class="py-16 md:py-24 bg-surface-100">
      <div class="mx-auto max-w-7xl px-4 md:px-8 lg:px-12">
        <div class="max-w-3xl mx-auto text-center mb-12">
          <h2 class="font-inter text-3xl md:text-4xl font-semibold text-primary-700">Relevante Erfolgsgeschichte</h2>
          <p class="mt-4 font-lora text-lg text-surface-900 opacity-90">Sehen Sie, wie wir diese Leistung eingesetzt haben, um für einen Kunden wie Sie greifbare Ergebnisse zu erzielen.</p>
        </div>
        <div class="max-w-4xl mx-auto">
          <FeaturedCard 
            href={`/de/projekte/${relatedCaseStudy.slug.replace('de/', '')}`}
            image={relatedCaseStudy.data.featured_image.src}
            imageAlt={relatedCaseStudy.data.featured_image.alt}
            title={relatedCaseStudy.data.client_name}
            subtitle={relatedCaseStudy.data.project_summary}
            stat={relatedCaseStudy.data.impact_statistic}
          />
        </div>
      </div>
    </section>
  )}

  {testimonial && (
     <section class="py-16 md:py-24 bg-surface-50">
      <div class="mx-auto max-w-7xl px-4 md:px-8 lg:px-12">
        <TestimonialBlock
          quote={testimonial.data.quote}
          authorName={testimonial.data.author_name}
          authorTitle={testimonial.data.author_title}
          avatar={testimonial.data.client_logo?.src || `https://source.unsplash.com/random/128x128/?portrait,professional`}
        />
      </div>
    </section>
  )}

  <CtaBanner
    title="Bereit, Ihre Herausforderung anzugehen?"
    subtitle={`Lassen Sie uns besprechen, wie unsere Expertise im Bereich ${data.title} Ihr Unternehmen voranbringen kann.`}
    buttonLabel="Kostenloses Beratungsgespräch vereinbaren"
    buttonHref="/de/kontakt"
  />

</BaseLayout>
```